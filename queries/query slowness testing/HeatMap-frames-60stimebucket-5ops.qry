<?xml version="1.0"?>
<!DOCTYPE plan SYSTEM "queryplan.dtd">

<plan top="frameLength">

<csvstream id="csvstream"
    file_name="../../JGMtests/data/2nd-half_to_end-5000000.csv"
    attr_names="sid ts x y z v_v v_a vx vy vz ax ay az" 
    attr_types="int TS int int int int int int int int int int int"
/>

<heatmapMapSidToPid id="heatmapMapSidToPid" input="csvstream"
/>

<gridFrame id="gridFrame" input="heatmapMapSidToPid"
    groupby="pid"
    timeattr="ts"
    xgridattr="x"
    ygridattr="y"
    xcells="16"
    ycells="25"
    corners="0 -33960 52483 33965"
/>

<splitFrameOnWindowBoundary id="splitFrameOnWindowBoundary" input="gridFrame"
    time1attr="st_ts"
    time2attr="end_ts"
    starttime="13086639146403495"
    boundarygap="1000000000000"
/>

<expression id="frameLength" input="splitFrameOnWindowBoundary"
    variables="st_ts end_ts"
    expression="result = end_ts - st_ts"
/>

</plan>
